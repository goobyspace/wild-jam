[gd_scene load_steps=17 format=3 uid="uid://ccmmifktpgjib"]

[ext_resource type="Script" uid="uid://b6mge7o3yiv0u" path="res://scripts/player/movement/player_movement.gd" id="1_4flbx"]
[ext_resource type="Script" uid="uid://bj3a4q0fcalg4" path="res://scripts/player/hp/player_hp.gd" id="2_g2els"]
[ext_resource type="Script" uid="uid://cbwmm7hsi6ade" path="res://scripts/player/hp/hp_bar.gd" id="2_qhqgy"]
[ext_resource type="Script" uid="uid://cry7gmyp7ch24" path="res://scripts/player/attacks/player_attack_controller.gd" id="4_dqkch"]
[ext_resource type="PackedScene" uid="uid://c5pmsswu5f7bf" path="res://scripts/player/attacks/weapons/sword/sword_main.tscn" id="5_qlg0r"]
[ext_resource type="PackedScene" uid="uid://bs616ldd5wkpy" path="res://assets/models/fox_knight.gltf" id="6_tuyoq"]
[ext_resource type="Animation" uid="uid://upcxm4b2g5a4" path="res://assets/models/animations/tpose.res" id="7_y4r1p"]
[ext_resource type="Animation" uid="uid://qixm0x3wvrbs" path="res://assets/models/animations/run forward.res" id="8_d2wvv"]
[ext_resource type="Animation" uid="uid://7ba1wfxtesni" path="res://assets/models/animations/idle.res" id="9_3v2ag"]
[ext_resource type="Animation" uid="uid://b8iswqochcsyt" path="res://assets/models/animations/attack.res" id="10_jej6c"]
[ext_resource type="Script" uid="uid://u5jc1fp3va0w" path="res://scripts/player/movement/player_animations.gd" id="11_d2wvv"]

[sub_resource type="BoxShape3D" id="BoxShape3D_fjrip"]
size = Vector3(0.9, 4.7, 0.9)

[sub_resource type="ViewportTexture" id="ViewportTexture_3vyb7"]
viewport_path = NodePath("SubViewport")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_3vyb7"]
bg_color = Color(0.117647, 0, 0, 1)
skew = Vector2(0.2, 0)
corner_detail = 16
shadow_color = Color(0, 0, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_g2els"]
bg_color = Color(0.746585, 2.00946e-06, 8.66354e-07, 1)
skew = Vector2(0.2, 0)
corner_detail = 16

[sub_resource type="AnimationLibrary" id="AnimationLibrary_f1ej7"]
_data = {
&"attack": ExtResource("10_jej6c"),
&"idle": ExtResource("9_3v2ag"),
&"run forward": ExtResource("8_d2wvv"),
&"tpose": ExtResource("7_y4r1p")
}

[node name="Player" type="CharacterBody3D" node_paths=PackedStringArray("collision", "model", "health_bar", "animation_player")]
platform_wall_layers = 1
script = ExtResource("1_4flbx")
collision = NodePath("CollisionShape3D")
model = NodePath("model")
health_bar = NodePath("health_bar")
animation_player = NodePath("model/animations")
idle_animation = ExtResource("9_3v2ag")
move_animation = ExtResource("8_d2wvv")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.05, 2.3, 0.05)
shape = SubResource("BoxShape3D_fjrip")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(-4.37114e-08, -0.707107, 0.707107, 0, 0.707107, 0.707107, -1, 3.09086e-08, -3.09086e-08, 75, 75, 0)
projection = 1
current = true
size = 30.0
near = 0.001
far = 1500.0

[node name="health_bar" type="Sprite3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5.4, 0)
pixel_size = 0.003
billboard = 1
no_depth_test = true
texture = SubResource("ViewportTexture_3vyb7")

[node name="SubViewport" type="SubViewport" parent="."]
transparent_bg = true
size = Vector2i(680, 80)

[node name="ProgressBar" type="ProgressBar" parent="SubViewport" node_paths=PackedStringArray("health")]
offset_left = 12.0
offset_right = 668.0
offset_bottom = 80.0
theme_override_styles/background = SubResource("StyleBoxFlat_3vyb7")
theme_override_styles/fill = SubResource("StyleBoxFlat_g2els")
value = 10.0
show_percentage = false
script = ExtResource("2_qhqgy")
health = NodePath("../../health")

[node name="health" type="Node" parent="."]
script = ExtResource("2_g2els")

[node name="attack_controller" type="Node" parent="." node_paths=PackedStringArray("mainAttack")]
script = ExtResource("4_dqkch")
mainAttack = NodePath("SwordMain")

[node name="SwordMain" parent="attack_controller" node_paths=PackedStringArray("animation_player") instance=ExtResource("5_qlg0r")]
animation_player = NodePath("../../model/animations")
animation = ExtResource("10_jej6c")

[node name="model" parent="." instance=ExtResource("6_tuyoq")]

[node name="animations" type="AnimationPlayer" parent="model"]
libraries = {
&"player": SubResource("AnimationLibrary_f1ej7")
}
autoplay = "player/idle"
playback_default_blend_time = 0.5
script = ExtResource("11_d2wvv")

[connection signal="animation_finished" from="model/animations" to="model/animations" method="_on_animation_finished"]
